from malwareDetection import logger
from malwareDetection.pipeline.data_ingestion_pipeline import DataIngestionPipeline
from malwareDetection.pipeline.data_validation_pipeline import DataValidationPipeline
from malwareDetection.pipeline.data_transformation_pipeline import DataTransformationPipeline
import sys

logger.info("============ STARTING PIPELINE ===============")

try:
    logger.info("Stage 1 - Data Ingestion starting ")
    ingest = DataIngestionPipeline()
    ingest.run()
    logger.info("Stage 1 - Data Ingestion ended")
except Exception as e:
    logger.info(f"ERROR: {e}")
    sys.exit(1)

try:
    logger.info("Stage 2 - Data Validation starting ")
    validator = DataValidationPipeline()
    validator.run()
    logger.info("Stage 2 - Data Validation ended")
except Exception as e:
    logger.info(f"ERROR: {e}")
    sys.exit(1)

try:
    logger.info("Stage 3 - Data Transformation starting ")
    obj = DataTransformationPipeline()
    obj.run()
    logger.info("Stage 3 - Data Transformation ended")
except Exception as e:
    logger.info(f"ERROR: {e}")
    raise e

logger.info("============ ENDING PIPELINE ===============")