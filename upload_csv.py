import pandas as pd
from pymongo import MongoClient
import os

# MongoDB connection details (replace these with your MongoDB Atlas credentials)
mongo_uri = os.environ.get("SERVER_URI")
client = MongoClient(mongo_uri)
db = client['MalwareModel']
collection = db['malwareData']

# Read the CSV file into a Pandas DataFrame
file_path = 'data/TUANDROMD.csv'  # Replace with the path to your CSV file
data = pd.read_csv(file_path)

# Convert the DataFrame to a list of dictionaries (JSON-like format)
data_dict = data.to_dict(orient='records')

# Insert the data into the MongoDB collection
collection.insert_many(data_dict)

print("Data uploaded to collection successfully.")

