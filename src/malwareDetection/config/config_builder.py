from malwareDetection.utils import read_yaml
from malwareDetection.constants import *
from malwareDetection.entity.entities import *
import sys
from malwareDetection import logger
from pathlib import Path

class ConfigurationBuilder():
    def __init__(
        self,
        config = CONFIG_FILE,
        params = PARAMS_FILE,
        schema = SCHEMA_FILE,
    ):
        self.config = read_yaml(Path(config))
        self.params = read_yaml(Path(params))
        self.schema = read_yaml(Path(schema))

    def DataIngestionConfigBuilder(self) -> DataIngestionEntity:
        try:
            config = self.config['DataIngestionConfig']
            entity = DataIngestionEntity(
                        artifact_path = Path(config["artifact_path"]),
                        database_name = config["database_name"],
                        collection_name = config["collection_name"]
                    )

        except:
            logger.info("ERROR: Data Ingestion entity config not set correctly")
            sys.exit(1)

        return entity
